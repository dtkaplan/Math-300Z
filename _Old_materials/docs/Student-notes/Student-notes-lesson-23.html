<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="YOUR NAME HERE">
<meta name="dcterms.date" content="2023-01-01">

<title>Spring 2023 Math 300Z - Math 300 Lesson 23 Notes</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
</head><body class="nav-fixed fullcontent"><span class="math inline" style="display: none;">
\(\newcommand{\Ptest}{\mathbb{P}}
\newcommand{\Ntest}{\mathbb{N}}
\newcommand{\given}{\ |\!\!|\  }
\)
</span>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../styles.css">




<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Math 300Z</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../Textbook/index.html">
 <span class="menu-text">Textbook</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../index.html">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../student-notes.html">
 <span class="menu-text">Student notes</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../faculty-notes.html">
 <span class="menu-text">Faculty notes</span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Math 300 Lesson 23 Notes</h1>
<p class="subtitle lead">Estimating sampling variation from a single sample</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>YOUR NAME HERE </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 1, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="overview" class="level2">
<h2 class="anchored" data-anchor-id="overview">Overview</h2>
<p>The authentic context for estimating the magnitude of sampling variation is when we have only a single sample, not the imagined set of samples that we studied in Lesson 23. The estimate of sampling variation is used to describe the precision of a sample summary which is often presented in the form of a confidence interval.</p>
<section id="reading" class="level3">
<h3 class="anchored" data-anchor-id="reading">Reading</h3>
<p><a href="https://dtkaplan.github.io/Math-300R/Textbook/Reading-notes-lesson-23.html">Lesson <strong>23</strong> from <em>LST</em></a></p>
</section>
<section id="objectives" class="level3">
<h3 class="anchored" data-anchor-id="objectives">Objectives</h3>
<p>23.1 Construct and interpret confidence intervals on model coefficients and relate the intervals to the sampling distribution.</p>
<p>23.2 Recognize that confidence intervals are only about sampling variation. They do not measure or summarize bias.</p>
<p><a href="../Objectives/Obj-lesson-23.html">Updated list of objectives</a></p>
</section>
<section id="libraries" class="level3">
<h3 class="anchored" data-anchor-id="libraries">Libraries</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mosaic)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(math300)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"Galton"</span>, <span class="at">package=</span><span class="st">"mosaicData"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
</section>
<section id="lesson" class="level2">
<h2 class="anchored" data-anchor-id="lesson">Lesson</h2>
<section id="exercise-23.1" class="level3">
<h3 class="anchored" data-anchor-id="exercise-23.1">Exercise 23.1</h3>
<p>The regression method was introduced in the 1880s by Francis Galton. In this exercise we’ll explore the same data used by Galton in his demonstration. The data are available to us as the <code>Galton</code> data frame in the <code>{mosaicData}</code> R package.</p>
<p>The unit of observation in <code>Galton</code> is a full-grown child living in a household with his or her parents. Each household is identified by a unique number, stored in the <code>family</code> column. The variable <code>height</code> records the child’s height in inches, while <code>mother</code> and <code>father</code> record the heights of the parents. The total number of children in the household is recorded in <code>nkids</code>. <code>sex</code> is also recorded.</p>
<p>Galton’s particular interest was in the heritability of measurable traits like height. At the time he worked, there was no theory of “genetics” or detailed understanding of how traits were passed from parents to child.</p>
<section id="task-1.1" class="level4">
<h4 class="anchored" data-anchor-id="task-1.1">Task 1.1</h4>
<p>The model specification <code>height ~ father + mother</code> can describe the extent to which children inherit their height at full-growth from their parents. Here are the coefficients from that model:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(height <span class="sc">~</span> father <span class="sc">+</span> mother, <span class="at">data =</span> Galton) <span class="sc">%&gt;%</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coef</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)      father      mother 
 22.3097055   0.3798970   0.2832145 </code></pre>
</div>
</div>
<p>The coefficients allow us to do a kind of thought experiment. Imagine a full-grown child of height 63 inches. Now imagine that same child but with a different father. The new father is 1 inch taller than the original father. According to the model coefficients, the child of the new father would be 63.38 inches tall, inheriting 0.38 of the new father’s extra height.</p>
<p>Whose height, the father’s or the mother’s, has a greater influence on the child’s height. Explain what you see in the coefficients that leads you to your answer.</p>
<p><em>Your answer</em>:</p>
</section>
<section id="task-1.2" class="level4">
<h4 class="anchored" data-anchor-id="task-1.2">Task 1.2</h4>
<p>Since we know there is inevitably sampling variation, we shouldn’t take all the digits of the <code>father</code> or <code>mother</code> coefficient at face value. The confidence intervals on those coefficients summarize the actual precision of the coefficients.</p>
<p>Calculate the confidence intervals from the same model as in Task 1.1.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For task 1.2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Looking at the confidence interval, reconsider your answer to the question from Task 1.2: Whose height, the father’s or the mother’s, has a greater influence on the child’s height. Explain what you see in the confidence intervals that leads you to your answer.</p>
<p><em>Your answer</em>:</p>
</section>
<section id="task-1.3" class="level4">
<h4 class="anchored" data-anchor-id="task-1.3">Task 1.3</h4>
<p>Confidence intervals can be wider or narrower depending on what other explanatory variables are included in the model specification. Calculate the confidence intervals on the coefficients from the model specification <code>height ~ father + mother + sex</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For task 1.3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Does including <code>sex</code> in the model make the confidence intervals broader or narrower?</p>
<p><em>Your answer</em>:</p>
</section>
<section id="task-1.4" class="level4">
<h4 class="anchored" data-anchor-id="task-1.4">Task 1.4</h4>
<p>It’s conventional wisdom that a wife and her husband are more similar in their height than would be a randomly selected woman or man. If this is so, then variation in wive’s heights should account for variation in their husbands’ heights.</p>
<p>To check this out, we can use the <code>mother</code> and <code>father</code> variables from <code>Galton</code> and the model specification <code>father ~ mother</code>. Train that model and find the confidence interval on the <code>mother</code> coefficient.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For task 1.4</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Does the confidence interval lead you to conclude that conventional wisdom matches what <code>Galton</code> has to say? Explain what specifically about the confidence interval leads to your conclusion.</p>
<p><em>Your answer</em>:</p>
<p>Do the thought experiment in which you increase the mother’s height by 12 inches. (That’s a lot!) According to the confidence interval, how much taller will the father be? Give a confidence interval.</p>
<p><em>Your answer</em>:</p>
</section>
<section id="task-1.5" class="level4">
<h4 class="anchored" data-anchor-id="task-1.5">Task 1.5</h4>
<p>If we were studying children and their parents in the same way an ecologist studies birds and their chicks, we might hypothesize that the children compete with one another for vital resources, and so the children from larger families will tend to be smaller than the children from smaller families.</p>
<p>Build the model <code>height ~ mother + father + sex + nkids</code> and look at the confidence interval on the <code>nkids</code> coefficient.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For task 1.5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>What do the data suggest, do kids compete for vital resources?</p>
<p><em>Your answer</em>:</p>
<p>So far as the <code>nkids</code> hypothesis is concerned, <code>mother</code>, <code>father</code>, and <code>sex</code> are not of direct interest. Such explanatory variables that are not of direct interest are called <strong>covariates</strong>. (They are perfectly ordinary explanatory variables, it’s just that we’re not directly interested in them.) The question might arise in your mind, why include explanatory variables if we’re not directly interested in them?</p>
<p>To answer this question, fit the simple model <code>height ~ nkids</code> and look at the confidence interval.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># lm(height ~ nkids, data = Galton) %&gt;% conf_interval()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>What does the confidence interval on the <code>nkids</code> coefficient from the simple model suggest to you about why including covariates is useful? (We’ll return to this topic in Lesson 29.)</p>
<p><em>Your answer</em>:</p>
</section>
</section>
<section id="exercise-23.2" class="level3">
<h3 class="anchored" data-anchor-id="exercise-23.2">Exercise 23.2</h3>
<p>A more complete presentation of confidence intervals would point out that the length of the interval depends not only on the sample size <span class="math inline">\(n\)</span>, but also on something called the “<strong>confidence level</strong>,” which is a number between 0 and 100%. In practice, confidence intervals are almost always presented at a confidence level of 95%, and that is the default for <code>conf_interval()</code>.</p>
<p>This exercise is a demonstration of what the “confidence level” is about. Understanding that will give you a better appreciation of why 95% is the confidence level used in practice.</p>
<p>The confidence level has to do with how the confidence interval might change from one sample to another. We’ll show this by generating many trials. We’ll use <code>dag01</code> for the demonstration. <code>dag01</code> has just two variables, <code>x</code> and <code>y</code>. The <code>x</code> variable is endogenous, but <code>y</code> is computed from <code>x</code> with the formula <code>1.5 * x + 4 + exo()</code>. Consequently, it’s reasonable to expect that the confidence interval on the <code>x</code> coefficient will include the “true” value from the formula: 1.5.</p>
<p>Let’s see if this works out. The following code implements drawing a sample from <code>dag01</code>, finding the confidence interval on the <code>x</code> coefficient, and setting <code>color</code> to black or red depending on whether the “true” value 1.5 is inside the confidence interval.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>one_trial <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">n =</span> <span class="dv">10</span>, <span class="at">level=</span><span class="fl">0.95</span>) {</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data=</span><span class="fu">sample</span>(dag01, <span class="at">size=</span>n)) <span class="sc">%&gt;%</span> </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">conf_interval</span>(<span class="at">level=</span>level) <span class="sc">%&gt;%</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(term <span class="sc">==</span> <span class="st">"x"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">.color =</span> <span class="fu">ifelse</span>(<span class="fl">1.5</span> <span class="sc">&gt;</span> .lwr <span class="sc">&amp;</span> <span class="fl">1.5</span> <span class="sc">&lt;</span> .upr,</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"black"</span>, <span class="st">"red"</span>))</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You are not required to understand the code in <code>one_trial()</code>, but you should be able to make sense of the its output.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">one_trial</span>(<span class="at">n=</span><span class="dv">20</span>, <span class="at">level=</span><span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 4
  term   .lwr  .upr .color
  &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; 
1 x      1.28  2.35 black </code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">one_trial</span>(<span class="at">n=</span><span class="dv">20</span>, <span class="at">level=</span><span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 4
  term   .lwr  .upr .color
  &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; 
1 x     0.846  1.74 black </code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">one_trial</span>(<span class="at">n=</span><span class="dv">20</span>, <span class="at">level=</span><span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 4
  term   .lwr  .upr .color
  &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; 
1 x     0.599  1.58 black </code></pre>
</div>
</div>
<p>Here’s how to generate 100 trials, each involving a sample of size <span class="math inline">\(n=20\)</span> turned into a confidence interval on <code>x</code> at the 95% confidence level.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>Trials <span class="ot">&lt;-</span> <span class="fu">do</span>(<span class="dv">100</span>) <span class="sc">*</span> <span class="fu">one_trial</span>(<span class="at">n=</span><span class="dv">20</span>, <span class="at">level=</span><span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The next chunk defines a special-purpose function that will make a graphic showing all of the trials. The graphic is not in RESPEX format. The vertical axis is the trial number. The horizontal axis is in units of the <code>x</code> coefficient. Each horizontal line segment shows one confidence interval. There is also a blue vertical vertical line marking the value 1.5. By no means are you expected to create graphics of this sort, but you should be able to interpret the graph itself.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>graph_trials <span class="ot">&lt;-</span> <span class="cf">function</span>(Trials) {</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(Trials, <span class="fu">aes</span>(<span class="at">x=</span>.lwr, <span class="at">xend=</span>.upr, </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y=</span>.index, <span class="at">yend=</span>.index,</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">color=</span>.color)) <span class="sc">+</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_segment</span>() <span class="sc">+</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="fl">1.5</span>, <span class="at">color=</span><span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"Trial number"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"x coefficient"</span>) <span class="sc">+</span> </span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_identity</span>()</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To use this simulation, generate a set of trials and graph them, like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>Trials <span class="ot">&lt;-</span> <span class="fu">do</span>(<span class="dv">100</span>) <span class="sc">*</span> <span class="fu">one_trial</span>(<span class="at">n=</span><span class="dv">20</span>, <span class="at">level=</span><span class="fl">0.95</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">graph_trials</span>(Trials)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Student-notes-lesson-23_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Each of the 100 confidence intervals is drawn as a horizontal line. Whether or not a particular confidence interval includes the blue line is somewhat random, but the large majority of them do. The one’s that don’t are colored red to make them easy to spot.</p>
<section id="task-2.1" class="level4">
<h4 class="anchored" data-anchor-id="task-2.1">Task 2.1</h4>
<p>Run the code chunk to generate the samples several times in a row. Take note of how many of the 100 confidence intervals do not touch the blue line.</p>
<p>Based on your observations, about what fraction of the confidence intervals do touch the blue line?</p>
<p><em>Your answer</em>:</p>
</section>
<section id="task-2.2" class="level4">
<h4 class="anchored" data-anchor-id="task-2.2">Task 2.2</h4>
<p>Repeat the simulation, but setting <code>level=0.50</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Trials &lt;- do(100) * one_trial(n=20, level=0.50)</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co"># graph_trials(Trials)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Based on your observations, about what fraction of the confidence intervals touch the blue line?</p>
<p><em>Your answer</em>:</p>
<p>Compare the typical length of the confidence interval in the <code>level=0.50</code> simulation to those in the <code>level=0.95</code> simulation. How are they different? Does this explain why more of the <code>level=0.95</code> confidence intervals touch the blue line?</p>
<p><em>Your answer</em>:</p>
</section>
<section id="task-2.3" class="level4">
<h4 class="anchored" data-anchor-id="task-2.3">Task 2.3</h4>
<p>Go back to Task 2.2, still using the levels 0.95 and 0.50. But this time, change the sample size from <span class="math inline">\(n=20\)</span> to <span class="math inline">\(n=80\)</span>.</p>
<p>In theory, how much shorter should the <span class="math inline">\(n=80\)</span> confidence intervals be than the <span class="math inline">\(n=20\)</span> intervals?</p>
<p><em>Your answer</em>:</p>
<p>In practice, do the <span class="math inline">\(n=80\)</span> confidence intervals intersect the blue line in the fraction indicated by the confidence level used?</p>
<p><em>Your answer</em>:</p>
<p>How about when <span class="math inline">\(n=500\)</span>, do the confidence intervals intersect the blue line the expected fraction of times?</p>
<p><em>Your answer</em>: That’s pretty amazing that we can generate such confidence intervals!</p>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>