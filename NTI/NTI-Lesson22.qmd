---
title: "Math 300R NTI Lesson `r (lesson <- 22)`"
subtitle: "DAGs, noise, and simulation"
author: "Prof. Danny Kaplan"
date: "`r format(Sys.time(), '%B %d, %Y')`"
output:
  html_document:
    theme: lumen
    toc: yes
    toc_float: yes
    css: NTI.css
  pdf_document:
    toc: yes
---


```{r setup, include=FALSE}
source("../_startup.R")
```

## Objectives

```{r child=Obj_file(lesson)}
```

## Reading

[Reading notes for Lesson 22](../Reading-notes/Reading-notes-lesson-22.qmd)


## Lesson

It's important for the students to realize that sampling variation is about the summary of a sample. There are many ways to summarize a sample. To bring this point home, ask the students to suggest summaries of the sort of data generated by `dag01`. The textbook uses the coefficient on the model `y ~ 1`, but that is just because I want to emphasize the use of models. (The coefficient from `y ~ 1` will be the mean of `y`, but that's not the point to make here.) When you have a handful of measure types to use, create a "summarize a sample" command. For instance, here is a command to summarize in three ways: the mean, the median, and the variance:

```{r}
Sample <- sample(dag01, size=10)
Sample %>%
  summarize(m = mean(y), med = median(y), s = sd(y))
```

I've used the variable `y` in the above, but maybe someone will want to do the mean of `x` or the variance of `x*y`.

The above command could be written in one line, but I like to make clear that we are summarizing a sample, so I use the intermediate object `Sample` to hold the sample before summarizing. 

Now construct an set of trials:

```{r}
Trials <- do(100) * {
  Sample <- sample(dag01, size=10)
  Sample %>%
    summarize(m = mean(y), med = median(y), s = sd(y))
}
```

Show the whole set of trials scrolling through the data frame `Trials`. 

```{r eval=FALSE}
View(Trials)
```

After they have seen the whole set of trials, summarize it. Since we are interested in sampling variation, the summary of the trials will be the standard deviation of the measures we used to summarize each individual sample.

```{r}
Trials %>%
  summarize(sd(m), sd(med), sd(s))
```

The remainder of the session should examine how the measure of sampling variation depends on each of two aspects of the simulation. 

- How many trials are used. (The results don't depend on this, but let the students find this out for themselves.)

- The sample size. (Famously, the sampling variation will go as $1/\sqrt{\strut n}$. )

## The "standard error"

## The confidence interval


## A possible cliff-hanger

Toward the end of the class, you might want to bring things back to real data. But let's be a little silly here. Pick some data frame of interest to the students and summarize it with model coefficients. I doubt that the `Hill_racing` data will be of much interest to students, but I'll write my illustration using it.

```{r}
sample(Hill_racing) %>%
  lm(time ~ distance, data = .) %>%
  coef()
```

Attentive students will howl at using `sample()` on a data frame rather than on a DAG. You can show them that the result of `sample()` is just to shuffle the order of the rows, and that the model coefficients don't depend on the order of the rows.

Then construct the trials and the summary of the trials:

```{r}
Trials <- do(10) * {
  sample(Hill_racing) %>%
    lm(time ~ distance, data = .) %>%
    coef()
}
Trials %>%
  summarize(sIntercept = sd(Intercept), sdistance = sd(distance))
```

Both the standard deviations are zero. In Lesson 23 we'll see ways to measure the amount of inherited variability that makes it way to the summaries of a data frame.
