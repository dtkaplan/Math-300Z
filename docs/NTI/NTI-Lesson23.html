<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Prof.&nbsp;Danny Kaplan">
<meta name="dcterms.date" content="2022-11-29">

<title>Spring 2023 Math 300 Revisions - Math 300R NTI Lesson r (lesson &lt;- 23)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Spring 2023 Math 300 Revisions</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html">
 <span class="menu-text">Proposal</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../lessons.html">
 <span class="menu-text">Lessons</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../layout.html">
 <span class="menu-text">Site layout</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../objective-list.html">
 <span class="menu-text">Objectives</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../LC-list.html">
 <span class="menu-text">LCs</span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Math 300R NTI Lesson 23</h1>
<p class="subtitle lead">sampling variation from a single sample</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Prof.&nbsp;Danny Kaplan </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 29, 2022</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="objectives" class="level2">
<h2 class="anchored" data-anchor-id="objectives">Objectives</h2>
<p>23.1 Use bootstrapping to estimate sampling variation.</p>
<p>23.2 Infer sampling variation from a regression table: “standard error” of a model coefficient.</p>
<p>23.3 Construct and interpret confidence intervals on a model coefficient and relate the interval to the sampling distribution.</p>
<p>23.4. Understand and use scaling of confidence interval length as a function of <span class="math inline">\(n\)</span>.</p>
</section>
<section id="reading" class="level2">
<h2 class="anchored" data-anchor-id="reading">Reading</h2>
<p>TBD</p>
</section>
<section id="lesson" class="level2">
<h2 class="anchored" data-anchor-id="lesson">Lesson</h2>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Setup
</div>
</div>
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"../_startup.R"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>The point of today’s lesson is to show how some properties of the sampling distribution can be estimated from a single sample, rather than the many trials of sample-then-summarize that we used in Lesson 22.</p>
</section>
<section id="bootstrapping" class="level2">
<h2 class="anchored" data-anchor-id="bootstrapping">Bootstrapping</h2>
<p>One approach is to mimic what we did when we had a DAG available: run many trials. But all we have is a sample, not the DAG. Can we run many trials from the sample itself?</p>
<p>Let’s use the <code>moderndive::amazon_books</code> data set and the model tilde <code>list_price ~ num_pages</code></p>
<p>Here’s the results on the actual data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(list_price <span class="sc">~</span> num_pages, <span class="at">data =</span> moderndive<span class="sc">::</span>amazon_books) <span class="sc">%&gt;%</span> <span class="fu">coefficients</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)   num_pages 
 11.8438357   0.0198815 </code></pre>
</div>
</div>
<p>Interpretation: books cost about $12 plus 2 cents per page.</p>
<p>Here is our first stab at sampling from the data. Note that when sampling from a data set, <code>sample()</code> sets the sample size to be the same as the number of rows in the data set.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>trial <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(list_price <span class="sc">~</span> num_pages, <span class="at">data =</span> <span class="fu">sample</span>(moderndive<span class="sc">::</span>amazon_books)) <span class="sc">%&gt;%</span> </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coefficients</span>()</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>{<span class="fu">do</span>(<span class="dv">100</span>) <span class="sc">*</span> <span class="fu">trial</span>()} <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="fu">sd</span>(Intercept), <span class="fu">sd</span>(num_pages))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  sd(Intercept) sd(num_pages)
1  1.386919e-14   2.42335e-17</code></pre>
</div>
</div>
<div class="callout-note callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Questions
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>How to interpret these numbers? What are they telling us about the sampling distribution on the regression coefficients?</li>
<li>What’s wrong?</li>
<li>How to fix it?</li>
</ul>
</div>
</div>
<p>Introduce the <code>replace=TRUE</code> argument for <code>sample()</code>. Explain what it does and show the result. Is the result correct? We can’t know, because we don’t have access to the data-generating DAG in order to run many trials. But we can test the method on data generated from a DAG and confirm that it gives a reasonable result.</p>
<div class="callout-important callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Activity
</div>
</div>
<div class="callout-body-container callout-body">
<p>Each student should construct one from a dag of his or her choice.</p>
</div>
</div>
<section id="regression-table" class="level3">
<h3 class="anchored" data-anchor-id="regression-table">Regression table</h3>
<p>In the readings, we mentioned that there are formulas for the standard deviation of the sampling distribution. [NEEDED TO GIVE THIS A NAME EARLIER: “SD of sampling variability”, “standard error”] All you need to know about the formulas for the standard error is that i) they exist for linear regression and ii) the standard error is inversely proportional to <span class="math inline">\(\sqrt{n}\)</span>.</p>
<p>Show how to construct the regression table and where to find the relevant standard error</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">do</span>(<span class="dv">3</span>) <span class="sc">*</span> {<span class="fu">lm</span>(list_price <span class="sc">~</span> num_pages, <span class="at">data =</span> moderndive<span class="sc">::</span>amazon_books) <span class="sc">%&gt;%</span> <span class="fu">regression_summary</span>()}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 7
  term        estimate std.error statistic  p.value  .row .index
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;int&gt;  &lt;dbl&gt;
1 (Intercept)  11.8      1.79         6.63 1.40e-10     1      1
2 num_pages     0.0199   0.00479      4.15 4.24e- 5     2      1
3 (Intercept)  11.8      1.79         6.63 1.40e-10     1      2
4 num_pages     0.0199   0.00479      4.15 4.24e- 5     2      2
5 (Intercept)  11.8      1.79         6.63 1.40e-10     1      3
6 num_pages     0.0199   0.00479      4.15 4.24e- 5     2      3</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(list_price <span class="sc">~</span> num_pages, <span class="at">data =</span> moderndive<span class="sc">::</span>amazon_books) <span class="sc">%&gt;%</span> broom<span class="sc">::</span><span class="fu">glance</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 12
  r.squ…¹ adj.r…² sigma stati…³ p.value    df logLik   AIC   BIC devia…⁴ df.re…⁵
    &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;int&gt;
1  0.0511  0.0481  13.9    17.2 4.24e-5     1 -1304. 2614. 2625.  61999.     320
# … with 1 more variable: nobs &lt;int&gt;, and abbreviated variable names
#   ¹​r.squared, ²​adj.r.squared, ³​statistic, ⁴​deviance, ⁵​df.residual</code></pre>
</div>
</div>
</section>
</section>
<section id="margin-of-error" class="level2">
<h2 class="anchored" data-anchor-id="margin-of-error">Margin of error</h2>
<p>Confidence interval as estimate <span class="math inline">\(\pm 2\times\)</span> standard error.</p>
<p>Graphics for confidence interval. They need to know how to read them, not to make the graphics.</p>
</section>
<section id="learning-checks" class="level2">
<h2 class="anchored" data-anchor-id="learning-checks">Learning Checks</h2>
</section>
<section id="section" class="level2">
<h2 class="anchored" data-anchor-id="section">23.1</h2>
<p>Vocabulary: Sampling distribution, standard error, sampling variability, sample size</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Solution
</div>
</div>
<div class="callout-body-container callout-body">

</div>
</div>
<hr>
</section>
<section id="section-1" class="level2">
<h2 class="anchored" data-anchor-id="section-1">23.2</h2>
<p>In LC 22.2, using <code>do(100)</code>, you displayed the sampling distribution on the <code>x</code> coefficient of the model <code>y ~ x</code> applied to data simulated from <code>dag01</code>. Among other things, you calculated the standard deviation of the sampling distribution. Copy over the <code>proc1()</code> you wrote for LC 22.2 into your Rmd document for this lesson.</p>
<p>Calculate the standard deviation of the sampling distribution in each of these situations.</p>
<table class="table">
<thead>
<tr class="header">
<th>Number of trials</th>
<th>Sample size</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>do(100)</code></td>
<td><code>size=25</code></td>
</tr>
<tr class="even">
<td><code>do(100)</code></td>
<td><code>size=100</code></td>
</tr>
<tr class="odd">
<td><code>do(100)</code></td>
<td><code>size=400</code></td>
</tr>
<tr class="even">
<td><code>do(500)</code></td>
<td><code>size=25</code></td>
</tr>
<tr class="odd">
<td><code>do(500)</code></td>
<td><code>size=100</code></td>
</tr>
<tr class="even">
<td><code>do(500)</code></td>
<td><code>size=400</code></td>
</tr>
</tbody>
</table>
<p>In each case, the standard deviation is somewhat random, since new simulated data is collected from <code>dag01</code> each time. Nonetheless, there is a systematic pattern to how the standard deviation varies with the number of trials and with the sample size.</p>
<ol type="1">
<li><p>Describe how the standard deviation of the sampling distribution of the <code>x</code> coefficient varies with sample size. The general trend should be easy to see.</p></li>
<li><p>Does the standard deviation of the sampling distribution depend on the number of trials?</p></li>
<li><p>Going back to your results from (1), try to find a simple quantitative relationship that describes how the standard deviation depends on sample size. State that relationship in words.</p></li>
</ol>
<hr>
</section>
<section id="section-2" class="level2">
<h2 class="anchored" data-anchor-id="section-2">23.3</h2>
<p>We’re going to build models of prices of books based on the <code>moderndive::amazon_books</code> data frame. For each model, you will calculate the confidence interval of one or more coefficients in two ways:</p>
<ol type="i">
<li>Directly, using <code>confint()</code>.</li>
<li>Indirectly, using <code>regression_summary()</code></li>
</ol>
<p><strong>Model 1</strong>.</p>
<ol type="1">
<li><p>Model <code>list_price</code> versus <code>amazon_price</code>. Calculate the confidence intervals on the intercept and on the <code>amazon_price</code> coefficient.</p></li>
<li><p>Interpret the <code>amazon_price</code> coefficient in everyday words.</p></li>
</ol>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Solution to part 1.
</div>
</div>
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(list_price <span class="sc">~</span> amazon_price, <span class="at">data =</span> amazon_books) <span class="sc">%&gt;%</span> <span class="fu">confint</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                2.5 %   97.5 %
(Intercept)  3.716532 5.122737
amazon_price 1.049308 1.127471</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(list_price <span class="sc">~</span> amazon_price, <span class="at">data =</span> amazon_books) <span class="sc">%&gt;%</span> <span class="fu">regression_summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 5
  term         estimate std.error statistic   p.value
  &lt;chr&gt;           &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)      4.42    0.357       12.4 5.22e- 29
2 amazon_price     1.09    0.0199      54.8 2.82e-165</code></pre>
</div>
</div>
<ol type="1">
<li><p>You can read the confidence interval directly from the <code>confint()</code> report. For the regression report, calculate the confidence interval as the estimate <span class="math inline">\(\pm 2\)</span> times the “standard error.”</p></li>
<li><p>Just to look at the <code>amazon_price()</code> coefficient, the list price is about 8% higher than the Amazon price. Here, “about” means 5% to 13%. But don’t forget the intercept. The list price is, on average, about $4.50 higher than the 1.08 multiplier on the Amazon price.</p></li>
</ol>
</div>
</div>
<p><strong>Model 2</strong>.</p>
<ol start="3" type="1">
<li>Model <code>list_price</code> versus <code>amazon_price</code>, including <code>hard_paper</code> as a covariate.</li>
</ol>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Solution
</div>
</div>
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(list_price <span class="sc">~</span> amazon_price <span class="sc">+</span> hard_paper, <span class="at">data =</span> amazon_books) <span class="sc">%&gt;%</span> <span class="fu">confint</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                2.5 %   97.5 %
(Intercept)  3.028400 4.466996
amazon_price 1.042536 1.117826
hard_paperH  1.786977 3.882884</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(list_price <span class="sc">~</span> amazon_price <span class="sc">+</span> hard_paper, <span class="at">data =</span> amazon_books) <span class="sc">%&gt;%</span> <span class="fu">regression_summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  term         estimate std.error statistic   p.value
  &lt;chr&gt;           &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)      3.75    0.366      10.3  1.62e- 21
2 amazon_price     1.08    0.0191     56.5  9.65e-169
3 hard_paperH      2.83    0.533       5.32 1.93e-  7</code></pre>
</div>
</div>
<p>A hardcover costs about $2 to $4 more than a paperback.</p>
</div>
</div>
<div class="callout-warning callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note in draft
</div>
</div>
<div class="callout-body-container callout-body">
<p>Return to this example in the prediction lesson, to show how the confidence interval and the prediction interval are different.</p>
<p>Maybe also use it in one of the side-exercises on interaction terms. (The plan is not to strongly emphasize interaction terms but to refer to them in the occasional exercise.)</p>
</div>
</div>
<hr>
</section>
<section id="objective-23.1" class="level2">
<h2 class="anchored" data-anchor-id="objective-23.1">23.4 (Objective 23.1)</h2>
<p>We’re going to work with a very short dataset so that you can see directly what <strong>resampling</strong> a data frame does. (Ordinarily, you use resampling on an entire dataset, but here we are trying to make a point about the mechanism of resampling.)</p>
<ol type="1">
<li>Create a data frame <code>Five</code> that consists of the first five rows of <code>moderndive::mythbusters_yawn</code>. (Hint: Use <code>head()</code>.) Put the code for doing this into your Rmd homework paper. Note that <code>Five</code> contains the data from subjects 1 through 5.</li>
</ol>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Solution
</div>
</div>
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>Five <span class="ot">&lt;-</span> mythbusters_yawn <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<ol start="2" type="1">
<li><p>Use <code>resample()</code> to generate a new data frame from <code>Five</code>. At this point, you are just going to look at the result, processing it “by eye.” How many distinct human subjects are reported in the resampled data? (Your answer will likely differ from your classmates’, since resampling is done at random.)</p></li>
<li><p>Repeat (2) ten times. Each time, count the number of distinct human subjects.</p>
<ol type="i">
<li>Report those ten numbers on your write-up.</li>
<li>There will usually be one or more subjects repeated in the output. Look at these repeats carefully to check whether the variables have the same value for all the repeats or whether sometimes a repeated subject has different values for <code>group</code> or <code>yawn</code>.</li>
</ol></li>
</ol>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Solution
</div>
</div>
<div class="callout-body-container callout-body">
<p>Most of the time there will be 2, 3, or 4 distinct subject. The balance of the five rows will be repeats of other subjects. When a subject is repeated, the entire row is identical for all instances of that subject.</p>
</div>
</div>
<p><strong>Going further</strong> (optional). It’s pretty easy to automate the process of generating the resample and counting the number of distinct human subjects. Like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>{<span class="fu">resample</span>(Five) <span class="sc">%&gt;%</span> <span class="fu">unique</span>() <span class="sc">%&gt;%</span> <span class="fu">nrow</span>()}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3</code></pre>
</div>
</div>
<p>Using <code>do(1000)</code>, carry out 1000 trials of this process, saving the overall results in a data frame named <code>Trials</code>. What is the mean number of unique human subjects across the 1000 trials? What fraction is this of the five subjects.</p>
<p>Do the same again, but instead of using <code>Five</code>, use the whole <code>mythbusters_yawn</code> data frame (which has 50 rows). What fraction of the 50 human subjects, on average, shows up in the resamples?</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Solution
</div>
</div>
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>Trials <span class="ot">&lt;-</span> <span class="fu">do</span>(<span class="dv">1000</span>) <span class="sc">*</span> {<span class="fu">resample</span>(mythbusters_yawn) <span class="sc">%&gt;%</span> <span class="fu">unique</span>() <span class="sc">%&gt;%</span> <span class="fu">nrow</span>()}</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>Trials <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">mn =</span> <span class="fu">mean</span>(result)<span class="sc">/</span><span class="fu">nrow</span>(mythbusters_yawn))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       mn
1 0.63598</code></pre>
</div>
</div>
</div>
</div>
<hr>
</section>
<section id="objective-23.1-1" class="level2">
<h2 class="anchored" data-anchor-id="objective-23.1-1">23.5 (Objective 23.1)</h2>
<p>Return to the <code>amazon_books</code> data frame and the model <code>list_price ~ amazon_price</code>. In Exercise 23.3 you used the regression report to calculate the confidence intervals on the intercept and on the <code>amazon_price</code> coefficient. Now you are going to repeat the calculation in a different way, using randomization, a process called “<strong>bootstrapping</strong>”.</p>
<p>The basic process is to train a model using <em>resampled</em> data, like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(list_price <span class="sc">~</span> amazon_price, <span class="at">data =</span> <span class="fu">resample</span>(amazon_books)) <span class="sc">%&gt;%</span> <span class="fu">coefficients</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> (Intercept) amazon_price 
    4.412772     1.099959 </code></pre>
</div>
</div>
<p>Then, using <code>do(500)</code>, carry out 500 trials, saving the result in a data frame named <code>Trials</code>.</p>
<p>Process <code>Trials</code> to calculate both the mean and the standard deviation of the intercept and <code>amazon_price</code> columns. How do those results compare to the “standard error” results from the same model (without resampling) as you found in LC 23.3?</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Solution
</div>
</div>
<div class="callout-body-container callout-body">
<p>SOMETHING IS WRONG HERE. The means are about the same as from the regression report (as they should be) but the standard deviations are 3-4 times larger. WHAT GIVES?</p>
<p>THE PROBLEM IS a handful of books where the Amazon price is very different from the list price, because the book itself is very expensive (e.g.&nbsp;$100). Remedy</p>
<ol type="1">
<li>Switch to another data example, maybe doing both the regression report and the bootstrapping in one exercise.</li>
<li>This is an object lesson in outliers. Since the dollar discount is presumably <em>proportional</em> to the price, we should have used log transforms.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>Trials <span class="ot">&lt;-</span> <span class="fu">do</span>(<span class="dv">500</span>) <span class="sc">*</span> {<span class="fu">lm</span>(list_price <span class="sc">~</span> amazon_price, <span class="at">data =</span> <span class="fu">resample</span>(amazon_books)) <span class="sc">%&gt;%</span> <span class="fu">coefficients</span>()}</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>Trials <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">m1 =</span> <span class="fu">mean</span>(Intercept), </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">m2 =</span> <span class="fu">mean</span>(amazon_price), </span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">sintercept =</span> <span class="fu">sd</span>(Intercept), </span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">samazon_price =</span> <span class="fu">sd</span>(amazon_price))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        m1       m2 sintercept samazon_price
1 4.181543 1.108146  0.8781819    0.07565667</code></pre>
</div>
</div>
</div>
</div>
<hr>
</section>
<section id="documenting-software" class="level2">
<h2 class="anchored" data-anchor-id="documenting-software">Documenting software</h2>
<ul>
<li>File creation date: 2022-11-29</li>
<li>R version 4.2.1 (2022-06-23)</li>
<li><code>tidyverse</code> package version: 1.3.2</li>
<li><code>mosaic</code> package version: 1.8.4</li>
<li><code>math300</code> package version: 0.1.0.9000</li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>