{
  "hash": "4c84979b64daaa8ae381305e26888e95",
  "result": {
    "markdown": "---\ntitle: \"Math 300R NTI Lesson 21\"\nsubtitle: \"DAGs, noise, and simulation\"\nauthor: \"Prof. Danny Kaplan\"\ndate: \"October 14, 2022\"\noutput:\n  html_document:\n    theme: lumen\n    toc: yes\n    toc_float: yes\n    css: NTI.css\n  pdf_document:\n    toc: yes\n---\n\n\n\n\n## Objectives\n\n\n\n\n\n\n\n\n21.1 Determine whether a proposed graph is directed and acyclic.\n\n21.2 Having selected a response and one or more explanatory variables, identify other DAG notes as covariates. \n\n21.3 Generate data from simulations and use the data to model the relationships.\n\n\n## Reading\n\nTBD\n\n[Reading note sketches](../Reading-notes/Reading-notes-lesson-21.qmd)\n\n\n\n## Lesson\n\n*Remember that you will be running this more like a lab than a lecture. You want them using `R` and answering questions. Have them open the notes rmd and work through it together.*\n\n\n\n::: {.callout-tip icon=FALSE}\n## Setup \n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(math300)\nlibrary(mosaic)\n```\n:::\n\n:::\n\nIntroduce DAGs with multiple variables.\n\nGenerate data from them.\n\nUse the data to summarize the relationships. \n\n\n\n\n::: {.callout-tip icon=false}\n## Activity\n\n1. What happens when you use the model `y ~ x + a`? Interpret those coefficients. Are they consistent with the DAG?\n\n2. Are `x` and `a` related to one another? What does the DAG say about this? What does the model `a ~ x` say.\n:::\n\n\n\n\n\n::: {.callout-note}\n## Inference example: Regression to the mean\n\nConstruct the Galton height DAG, simulate, and show that Galton's finding is replicated. \n\n:::\n\n\n## Learning Checks\n\n\n\n\n\n\n\n\n\n## 21.1\n\nThe following command will generate a data frame with 1000 rows from `dag00` and calculate the variance of the `x` and `y` variables:\n\n::: {.cell}\n\n```{.r .cell-code}\nsample(dag00, size=1000) %>%\n  summarize(vx = var(x), vy = var(y))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 Ã— 2\n     vx    vy\n  <dbl> <dbl>\n1  4.14 0.949\n```\n:::\n:::\n\nCompare this result to the DAG tilde expressions\n\n::: {.cell}\n\n```{.r .cell-code}\ndag00\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[[1]]\nx ~ eps(2) + 5\n\n[[2]]\ny ~ eps(1) - 7\n\nattr(,\"class\")\n[1] \"list\"      \"dagsystem\"\n```\n:::\n:::\n\nIn the tilde expressions, `eps(2)` means to generate noise of magnitude 2.0.\n\n1. Is the argument to `eps()` specified in terms of the variance or the standard deviation?\n2. The tilde expression for `x` specifies that the constant `5` is to be added to `eps(2)`. Similarly, the constant `-7` is added to `y`.  How do these constants relate to the calculated magnitudes of `x` and `y`?\n\n### Solution\n\n1. The standard deviation. For instance, `x` has noise of magnitude 2. The variance of `x` is 4, the square of 2.\n2. The standard deviation (and therefore the variance) ignore such added constants.\n\n--------\n\n\n\n## 21.2\n\n@sec-signal-and-noise introduces the idea that variables consist of components. A simple breakdown is into two components: i. the part of the variable that is determined by other variables in the system (\"signal\") and ii. the random part of the variable (\"noise\"). The section uses `dag01` as an illustration of how a variable can be partly determined and partly random noise.\n\ni. Write and execute a command that will generate 500 rows of simulated data from `dag01` and will calculate the standard deviation of `x` and of `y`. \n\nii. What's the magnitude of `x` in the simulated data? What's the magnitude of `y`?\n\niii. Does this change if you use data with 1000 or 20000 rows?\n\n\n\n\n### Solution\n\ni. `sample(dag01, size=500) %>% summarize(sx = sd(x), sy=sd(y))`\nii. The standard deviation of `x` is about 1, the standard deviation of `y` is about 1.8.\niii. No, the values are roughly the same regardless of the size of the sample.\n\n----------\n\n\n\n## 21.3\n\n[DRAW several DAG-like graphs, one of which should be undirected in all edges, one should be undirected on one or two edges (but not all), and one should be cyclic and another acyclic.]\n\nReferring to the graphs in the figure, say which ones are DAGs. If a graph is not a DAG, say whether that's because it's not **directed** or because it's not **cyclic**.\n\n### Solution\n\n\n\n----------\n\n## 21.4\n\nGenerate simulated data from `dag01` with 1000 rows. Fit the regression model `y ~ x` to the data and examine the coefficients. \n\n1. How do the coefficients relate to the tilde expressions that define `dag01`?\n\n2. Instead of using the regression model `y ~ x`, where `y` is the response variable, try the regression model `x ~ y`. Do the coefficients from `x ~ y` correspond in any simple way to the tilde expressions that define `dag01`?\n\n### Solution\n\n::: {.cell}\n\n```{.r .cell-code}\nsample(dag01, size=1000) %>%\n  lm(y ~ x, data = .)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = y ~ x, data = .)\n\nCoefficients:\n(Intercept)            x  \n      4.063        1.511  \n```\n:::\n:::\n\nThe intercept corresponds to the additive constant (4) in the `y` tilde expression. The `x` coefficient corresponds to the multiplier on `x` in the tilde expression. \n\nThe formula for `x` isn't reflected by the coefficients.\n\n\nUsing `x` as the response variable:\n\n::: {.cell}\n\n```{.r .cell-code}\nsample(dag01, size=10000) %>%\n  lm(x ~ y, data = .)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = x ~ y, data = .)\n\nCoefficients:\n(Intercept)            y  \n    -1.8610       0.4639  \n```\n:::\n:::\n\nThese coefficients do not appear in the `dag01` tilde expressions.\n\n--------\n\n\n## Documenting software\n\n  * File creation date: 2022-10-14\n  * R version 4.2.1 (2022-06-23)\n  * `tidyverse` package version: 1.3.2\n  * `mosaic` package version: 1.8.4\n  * `math300` package version: 0.1.0.9000\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}