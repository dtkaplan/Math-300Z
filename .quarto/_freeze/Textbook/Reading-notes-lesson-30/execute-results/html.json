{
  "hash": "851ba680bcf1115a9069f1ed8261e4f1",
  "result": {
    "markdown": "---\ntitle: \"Confounding\"\noutput:\n  html_document:\n    theme: lumen\n    toc: yes\n    toc_float: yes\n    css: NTI.css\n  pdf_document:\n    toc: yes\n---\n\n\n\n\nMany people are concerned that the chemicals used by lawn-greening companies are a source of cancer or other illness. Imagine designing a  study that could confirm or refute this concern. The study would sample households, some with a history of using lawn-greening chemicals and others that have never used them. The question for the study designers: What variables to record?\n\nAn obvious answer: record both chemical use and a measure of health outcome, say whether anyone in that household has developed cancer in the last five years. We will suppose that the two possible levels of grass treatment are \"organic\" or \"chemicals.\" As for illness, the levels will be \"cancer\" or \"not.\" \n\nHere are two very simple DAGs describing possible theories:\n\n$$\\text{illness} \\leftarrow \\text{grass treatment}\\ \\ \\ \\ \\text{ or   }\\ \\ \\ \\ \\ \\text{illness} \\rightarrow \\text{grass treatment}$$\n\n\nThe DAG on the left expresses the belief among people who think chemical grass treatment might cause cancer. But belief is not necessarily reality, so we should consider the right-hand DAG. For example, one way to avoid the possibility of $\\text{illness} \\rightarrow \\text{grass treatment}$ is to include only households where cancer (if any) started *after* the grass treatment. Note that we are not ignoring the right-hand DAG; we are using the study design to disqualify it.\n\nThe statistical thinker knows that covariates are important. But which covariates? Answering that requires knowing a lot about the \"domain,\" that is, how things connect in the world. Such knowledge helps in thinking about the bigger picture and, in particular, possible covariates that connect plausibly to the response variable and the primary explanatory variable, grass treatment. \n\nFor now, suppose that the study designers have not yet become statistical thinkers and have rushed out to gather data on illness and grass treatment. Here are a few rows from the data (which we have simulated for this example):\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> grass </th>\n   <th style=\"text-align:left;\"> illness </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> organic </td>\n   <td style=\"text-align:left;\"> not </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> chemicals </td>\n   <td style=\"text-align:left;\"> not </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> chemicals </td>\n   <td style=\"text-align:left;\"> not </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> chemicals </td>\n   <td style=\"text-align:left;\"> not </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> organic </td>\n   <td style=\"text-align:left;\"> not </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> organic </td>\n   <td style=\"text-align:left;\"> not </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> organic </td>\n   <td style=\"text-align:left;\"> not </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> organic </td>\n   <td style=\"text-align:left;\"> not </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> chemicals </td>\n   <td style=\"text-align:left;\"> cancer </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> organic </td>\n   <td style=\"text-align:left;\"> not </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nAnalyzing such data is straightforward. First, check the overall cancer rate:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# overall cancer rate\nlm(zero_one(illness, one=\"cancer\") ~ 1, data = Cancer_data) %>% coefficients()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n(Intercept) \n      0.026 \n```\n:::\n:::\n\n\nIn these data, 2.6% of the sampled households had cancer in the last five years. How does the grass treatment affect that rate?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmod <- lm(zero_one(illness, one=\"cancer\") ~ grass, data = Cancer_data)\ncoefficients(mod)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n (Intercept) grassorganic \n  0.01246883   0.02258960 \n```\n:::\n:::\n\n\nFor households whose lawn treatment is \"organic,\" the risk of cancer is higher by 2.3 percentage points compared to households that treat their grass with chemicals. We were expecting the reverse, but it is what the data show. On the other hand, there is sampling variability to take into account. Look at the confidence intervals:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nconfint(mod)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                    2.5 %     97.5 %\n(Intercept)  -0.003103381 0.02804104\ngrassorganic  0.002469193 0.04271001\n```\n:::\n:::\n\n\nThe confidence interval on `grassorganic` does not include zero, but it comes close. So might the chemical treatment of grass be protective against cancer? Only at this point do the study designers do what they should have from the start: think about covariates.\n\nOne theory---just a theory---is this: Green grass is not a necessity, so the households who treat their lawn with chemicals tend to have money to spare. Wealthier people also tend to have better health, partly because of better access to health care. Another factor is that wealthier people can live in less polluted neighborhoods and are less likely to work in dangerous conditions, such as exposure to toxic chemicals. Such a link between wealth and illness points to a DAG hypothesis where \"`wealth`\" influences how the household's `grass` is treated and `wealth` similarly influences the risk of developing `cancer`. Like this: \n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Reading-notes-lesson-30_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\nA description of this structure of causality is, \"The effect of grass treatment on illness is **confounded** by wealth.\" The [Oxford Languages](https://languages.oup.com/google-dictionary-en/) dictionary offers two definitions of \"confound.\"\n\n1. *Cause surprise or confusion in someone, especially by acting against their expectations.* \n2. *Mix up something with something else so that the individual elements become difficult to distinguish.*\n\nThis second definition carries the statistical meaning of \"confound.\" \n\nThe first definition seems relevant to our story since the protagonist expected that chemical use would be associated with higher cancer rates and was surprised to find otherwise. But, the statistical thinker does not throw up her hands when dealing with mixed-up causal factors. Instead, she uses modeling techniques to untangle the influences of various factors.\n\nUsing covariates in models is one such technique. Our wised-up study designers go back to collect a covariate representing household wealth. Here is a glimpse at the updated data.\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> wealth </th>\n   <th style=\"text-align:left;\"> grass </th>\n   <th style=\"text-align:left;\"> illness </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 1.4283990 </td>\n   <td style=\"text-align:left;\"> organic </td>\n   <td style=\"text-align:left;\"> not </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.0628559 </td>\n   <td style=\"text-align:left;\"> chemicals </td>\n   <td style=\"text-align:left;\"> not </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.4382804 </td>\n   <td style=\"text-align:left;\"> chemicals </td>\n   <td style=\"text-align:left;\"> not </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.6084487 </td>\n   <td style=\"text-align:left;\"> chemicals </td>\n   <td style=\"text-align:left;\"> not </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.8033695 </td>\n   <td style=\"text-align:left;\"> organic </td>\n   <td style=\"text-align:left;\"> not </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> -0.9367287 </td>\n   <td style=\"text-align:left;\"> organic </td>\n   <td style=\"text-align:left;\"> not </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.6664468 </td>\n   <td style=\"text-align:left;\"> organic </td>\n   <td style=\"text-align:left;\"> not </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> -1.2445977 </td>\n   <td style=\"text-align:left;\"> organic </td>\n   <td style=\"text-align:left;\"> not </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> -1.3194594 </td>\n   <td style=\"text-align:left;\"> chemicals </td>\n   <td style=\"text-align:left;\"> cancer </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> -1.6162391 </td>\n   <td style=\"text-align:left;\"> organic </td>\n   <td style=\"text-align:left;\"> not </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\nHaving measured `wealth`, we can use it as a covariate in the model of `illness`: \n\n\n::: {.cell}\n\n```{.r .cell-code}\nlm(zero_one(illness, one=\"cancer\") ~ grass + wealth, data = Cancer_data) %>%\n  confint()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                   2.5 %        97.5 %\n(Intercept)   0.02468113  0.0574819325\ngrassorganic -0.04508107 -0.0009698601\nwealth       -0.05680934 -0.0356454288\n```\n:::\n:::\n\n\nWith `wealth` as a covariate, the model shows that (all other things being equal) \"organic\" lawn treatment reduces cancer risk. However, we do not see this directly from the `grass` and `illness` variables because all other things are not equal: wealthier people are more likely to use chemical lawn treatment. (Keep in mind that this is **simulated data**. Do not conclude from this example anything about the safety of the chemicals used for lawn greening.)\n\n::: {.callout-note}\n## Example: The flu vaccine\n\nAs you know, people are encouraged to get vaccinated before flu season. This recommendation is particularly emphasized for older adults, say, 60 and over. \n\nIn 2012, the *Lancet*, a leading medical journal, published a [systematic examination and comparison of many previous studies](https://www.thelancet.com/journals/laninf/article/PIIS1473-3099(11)70295-X/fulltext). [Such a study of earlier studies is called a *meta-analysis*.]{.aside} The *Lancet* article describes a hypothesis that existing flu vaccines may not be as effective as was originally found.\n\n>  *A series of observational studies undertaken between 1980 and 2001 attempted to estimate the effect of seasonal influenza vaccine on rates of hospital admission and mortality in [adults 65 and older]. Reduction in all-cause mortality after vaccination in these studies ranged from 27% to 75%. In 2005, these results were questioned after reports that increasing vaccination in people aged 65 years or older did not result in a significant decline in mortality. Five different research groups in three countries have shown that these early observational studies had substantially overestimated the mortality benefits in this age group because of unrecognized confounding. This error has been attributed to a healthy vaccine recipient effect: reasonably healthy older adults are more likely to be vaccinated, and a small group of frail, undervaccinated elderly people contribute disproportionately to deaths, including during periods when influenza activity is low or absent.*\n\n\n::: {.cell .fig-cap-location-margin layout-align=\"center\"}\n::: {.cell-output-display}\n![A DAG diagramming the \"healthy vaccine recipient\" effect](Reading-notes-lesson-30_files/figure-html/fig-healthy-vaccine-1.png){#fig-healthy-vaccine fig-align='center' width=50%}\n:::\n:::\n\n\n\n@fig-healthy-vaccine presents a network of causal influences that could shape the \"healthy vaccine recipient.\" People are more likely to become frail as they get older. Frail people are *less* likely to get vaccinated, but more likely to die in the next few months. The result is that vaccination is associated with reduced mortality, even if there is no direct link between vaccination and mortality. \n\n\n:::\n\n\n\n## Block that path!\n\nLet us look more generally at the possible causal connections among three variables, which we will call X, Y, and C. We will stipulate that X points causally toward Y and that C is a possible covariate. Like all DAGs, there cannot be a cycle of causation.  These conditions leave three distinct DAGs that do not have a cycle, shown in @fig-three-dags-cancer.\n\n\n::: {#fig-three-dags-cancer .cell .column-page-inset-right layout-ncol=\"3\"}\n::: {.cell-output-display}\n![C is a confounder.](www/abc-dag-1.png){#fig-three-dags-cancer-1 width=288}\n:::\n\n::: {.cell-output-display}\n![C is a mechanism.](www/abc-dag-2.png){#fig-three-dags-cancer-2 width=290}\n:::\n\n::: {.cell-output-display}\n![C is a consequence.](www/abc-dag-3.png){#fig-three-dags-cancer-3 width=288}\n:::\n\nThree different DAGs connecting X, Y, and C.\n:::\n\nC plays a different role in each of the three dags. In sub-figure (a), C causes both X and Y. In (b), part of the way that X influences Y is *through* C. We say, in this case, \"C is a mechanism by which X causes Y. In sub-figure (c), C does not cause either X or Y. Instead, C is a consequence of both X and Y.^[In any given real-world context, good practice calls for considering each possible DAG structure and concocting a story behind it. Such stories will sometimes be implausible, but there can also be surprises that give the modeler new insight.]\n\nTo understand how a DAG informs whether or not to include a covariate, \nIt will help to give general names to some of the sub-structures seen in the @fig-three-dags-cancer DAGs. @fig-dag-paths shows some of these sub-structures, removing other links that are not part of the structure.\n\n\n::: {#fig-dags-paths .cell .column-page-inset-right layout-ncol=\"4\"}\n::: {.cell-output-display}\n![Direct causal link from X to Y](www/abc-direct.png){#fig-dags-paths-1 width=288}\n:::\n\n::: {.cell-output-display}\n![Causal path from X through C to Y](www/abc-causal.png){#fig-dags-paths-2 width=290}\n:::\n\n::: {.cell-output-display}\n![Correlating path connecting X and Y via C](www/abc-correlating.png){#fig-dags-paths-3 width=288}\n:::\n\n::: {.cell-output-display}\n![C as a consequence of X and Y](www/abc-collider.png){#fig-dags-paths-4 width=288}\n:::\n\nSub-structures seen in @fig-three-dags-cancer.\n:::\n\n\n- A \"**direct causal link**\" between X and Y. There are no intermediate nodes.\n\n- A \"**causal path**\" from C to X and on to Y. A causal path is one where, starting at the originating node, flow along the arrows can get to the terminal node, passing through all intermediate nodes. \n\n- A \"**correlating path**\" from Y through X to C. Correlating paths are distinct from causal paths because, in a correlating path, there is no way to get from one end to the other by following the flows.\n\n- A \"**collider**\" `wealth`. In other words, both X and Y are causes of C. \n\nLook back to @fig-three-dags-cancer(a), where `wealth` is a confounder. A confounder is always an intermediate node in a *correlating path*. \n\n\n:::\n\nIncluding a covariate either blocks or opens the pathway on which that covariate lies. Which it will be depends on the kind of pathway. A causal path, as in @fig-dags-paths(b), is blocked by including the covariate. Otherwise, it is open. A correlating path (@fig-dags-path(c)) is similar: the path is open unless the covariate is included in the model. A colliding path, as in @fig-dags-paths(d), is blocked *unless* the covariate is included---the opposite of a causal path.  \n\nOften, covariates are selected to block all paths except the direct link between the explanatory and response variable. This means *do* include the covariate if it is on a correlating path and *do not* include it if the covariate is at the collision point.\n\nAs for a causal path, the choice depends on what is to be studied. Consider the DAG drawn in @fig-three-dags-cancer(b), reproduced here for convenience: \n\n\n::: {.cell .column-margin}\n::: {.cell-output-display}\n![](www/grass-dag-2.png){width=312}\n:::\n:::\n\n\n`grass` influences `illness` through two distinct paths: \n\ni. the direct link from `grass` to `illness`.\nii. the causal pathway from `grass` through `wealth` to `illness`. \n\nAdmittedly, it is far-fetched that choosing to green the grass makes a household wealthier, but focus on the topology of the DAG and not the unlikeliness of this specific causal scenario.\n\nThere is no way to block a direct link from an explanatory variable to a response. If there were a reason to do this, the modeler probably selected the wrong explanatory variable. \n\nBut there is a genuine choice to be made about whether to block pathway (ii). If the interest is the purely biochemical link between grass-greening chemicals and illness, then block pathway (ii). However, if the interest is in the *total* effect of `grass` and `illness`, including both biochemistry and the sociological reasons why `wealth` influences `illness`, then leave the pathway open.\n\n\n::: {.callout-warning}\n## In draft: Some resources\n\nhttps://towardsdatascience.com/causal-effects-via-dags-801df31da794\n\nhttps://towardsdatascience.com/causal-effects-via-the-do-operator-5415aefc834a\n",
    "supporting": [
      "Reading-notes-lesson-30_files/figure-html"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}